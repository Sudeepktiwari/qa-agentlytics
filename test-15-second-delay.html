<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test 15-Second Scroll Delay</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        line-height: 1.6;
      }
      .section {
        height: 100vh;
        padding: 40px;
        margin: 20px 0;
        border: 2px solid #ddd;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
      }
      .section:nth-child(odd) {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }
      .section:nth-child(even) {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
      }
      .timer {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 15px;
        border-radius: 8px;
        font-family: monospace;
        z-index: 10000;
      }
      .status {
        position: fixed;
        top: 20px;
        left: 20px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 15px;
        border-radius: 8px;
        max-width: 300px;
        font-size: 12px;
        z-index: 10000;
      }
      .cta-button {
        background: #ff6b6b;
        color: white;
        padding: 15px 30px;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        cursor: pointer;
        margin: 10px;
      }
    </style>
  </head>
  <body>
    <div class="timer" id="timer">Time since last scroll: 0s</div>

    <div class="status" id="status">
      Scroll Status: Ready<br />
      Widget Status: Loading...
    </div>

    <div class="section">
      <h1>üè† Welcome Section</h1>
      <p>
        This is the top section. Try scrolling down and then stopping for 15
        seconds to trigger a contextual question.
      </p>
      <p>
        <strong>Timer Change:</strong> Scroll delays increased from 5 seconds to
        15 seconds
      </p>
      <button class="cta-button">Get Started</button>
    </div>

    <div class="section">
      <h2>üí∞ Pricing Section</h2>
      <p>Premium Business Solutions - $299/month</p>
      <p>
        Stop scrolling here and wait 15 seconds to see if a contextual question
        appears about pricing!
      </p>
      <ul style="text-align: left; max-width: 400px">
        <li>Unlimited automations</li>
        <li>Advanced integrations</li>
        <li>24/7 premium support</li>
        <li>Custom workflows</li>
      </ul>
      <button class="cta-button">Start Free Trial</button>
    </div>

    <div class="section">
      <h2>‚≠ê Features Section</h2>
      <p>Discover our amazing features and capabilities</p>
      <p>
        Try stopping your scroll here for 15 seconds to test the new timing!
      </p>
      <div
        style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          max-width: 600px;
        "
      >
        <div>ü§ñ AI-Powered</div>
        <div>üìä Analytics</div>
        <div>üîó Integrations</div>
        <div>üîí Security</div>
      </div>
    </div>

    <div class="section">
      <h2>üí¨ Testimonials Section</h2>
      <p>
        "This platform transformed our entire workflow. We've seen a 300%
        increase in efficiency."
      </p>
      <p><em>- Sarah Johnson, CTO at TechCorp</em></p>
      <p>
        Stop scrolling here and wait 15 seconds to test contextual questions for
        testimonials!
      </p>
    </div>

    <div class="section">
      <h2>üìû Contact Section</h2>
      <p>Ready to get started? Contact us today!</p>
      <p>Final test area - stop scrolling here for 15 seconds</p>
      <button class="cta-button">Contact Us</button>
      <button class="cta-button">Book Demo</button>
    </div>

    <script>
      // Timer to track time since last scroll
      let lastScrollTime = Date.now();
      let timerInterval;
      let scrollTimeout;

      function updateTimer() {
        const now = Date.now();
        const timeSinceScroll = Math.floor((now - lastScrollTime) / 1000);
        document.getElementById(
          "timer"
        ).textContent = `Time since last scroll: ${timeSinceScroll}s`;

        // Update status
        const status = document.getElementById("status");
        let scrollStatus = "Idle";
        if (timeSinceScroll < 1) {
          scrollStatus = "Scrolling";
        } else if (timeSinceScroll < 15) {
          scrollStatus = `Waiting (${15 - timeSinceScroll}s left)`;
        } else {
          scrollStatus = "Ready for contextual question";
        }

        status.innerHTML = `
                Scroll Status: ${scrollStatus}<br>
                Widget Status: ${
                  window.chatWidget ? "Loaded" : "Loading..."
                }<br>
                Last Scroll: ${timeSinceScroll}s ago<br>
                Expected Delay: 15 seconds
            `;
      }

      function handleScroll() {
        lastScrollTime = Date.now();

        // Clear existing timeout
        if (scrollTimeout) {
          clearTimeout(scrollTimeout);
        }

        // Set new timeout to simulate widget behavior
        scrollTimeout = setTimeout(() => {
          console.log(
            "üéØ 15-second delay completed - widget should trigger contextual question now"
          );

          // Highlight the timer when 15 seconds have passed
          const timer = document.getElementById("timer");
          timer.style.background = "#4caf50";
          timer.style.fontWeight = "bold";

          setTimeout(() => {
            timer.style.background = "rgba(0,0,0,0.8)";
            timer.style.fontWeight = "normal";
          }, 2000);
        }, 15000); // 15 seconds to match widget timing
      }

      // Setup event listeners
      window.addEventListener("scroll", handleScroll);

      // Start timer
      timerInterval = setInterval(updateTimer, 100);

      // Initial timer update
      updateTimer();

      // Load widget for testing
      window.addEventListener("load", () => {
        console.log("üß™ Testing 15-second scroll delay");

        // Try to inject widget
        const script = document.createElement("script");
        script.src = "/api/widget?admin_id=test123";
        script.onload = () => {
          console.log(
            "‚úÖ Widget loaded - test by scrolling and stopping for 15 seconds"
          );
        };
        script.onerror = () => {
          console.log(
            "‚ùå Widget failed to load - timer will still show 15-second behavior"
          );
        };
        document.head.appendChild(script);
      });

      // Log scroll behavior for debugging
      window.addEventListener("scroll", () => {
        console.log("üìú Scroll detected - 15-second timer restarted");
      });
    </script>
  </body>
</html>
